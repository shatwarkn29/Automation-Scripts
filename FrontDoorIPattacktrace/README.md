# Automation Scripts for FrontDoor WAF Error Analysis

This repository provides a automation script (FrontDoor-IP-Attack-Trace.ps1) designed to streamline the process of collecting and analyzing error logs generated by your Azure FrontDoor Web Application Firewall (WAF).

This script collects the top 5 IP addresses that have attacked a specific Azure resource within the past 24 hours. It generates detailed logs for each IP address and sends the data as email attachments using SendGrid.


## Key Features:

* **Automated Error Collection** : Script execution automates the retrieval of error logs based on your customized query, saving you time and effort.

* **Customizable Query** : Tailor the query within FrontDoor-IP-Attack-Trace.ps1 to match your specific requirements.

* **CSV Output**: Error log data is exported to a CSV file for further analysis or storage.

* **Actionable Insights** : Analyze error logs to identify blocked requests, malicious IP addresses, and potential security concerns.

* **Email Notifications** (Optional): Integrate email alerts using the provided example or your preferred method. If you are this method then using this script you can send the mail to multiple peoples by including their mail address in RecipientEmail seperated by commas (`,`). 

## Prerequisites:

* **Azure Subscription**: You'll need an active Azure subscription to access the relevant resources.
FrontDoor Setup and WAF Policy: Ensure you have a functioning FrontDoor configuration with a WAF policy in place.

* **PowerShell Modules**: Install the required PowerShell modules (AzureCli, Az).

* **Resource Details**: Obtain the following information from your FrontDoor setup:

    Subscription ID
    Resource Group Name
    Resource Name
    Workspace Name
    Workspace ID
    Additional Requirements (for Email Notifications)

* **SendGrid Account**: Create a SendGrid account if you wish to send email notifications using their API.

* **SendGrid API Key**: Obtain your API key from SendGrid (replace **AzEu2Reziai-SendGridAPIkey** in the script with your actual key).


# Usage
* Save the script as FrontDoor-IP-Attack-Trace.ps1
* Run the script with the necessary parameters:

        .\FrontDoor-IP-Attack-Trace.ps1 -SubscriptionId "your_subscription_id" -ResourceGroupName "your_resource_group_name" -Resource "your_resource_name" -WorkspaceName "your_workspace_name" -WorkspaceId "your_workspace_id" -senderEmail "your_sender_email" -recipientEmail "recipient_email1,recipient_email2"
